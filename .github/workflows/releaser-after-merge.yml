name: Release Tag creation
on:
    pull_request:
        branches:
            - 'release/**'
            - 'release/**-Beta.*'
env:
    APP_VERSION: ''
jobs:
    ci:
        name: Continuous Integration on release
        if: github.event.pull_request.merged == true
        permissions:
            actions: read
            contents: read
            security-events: write
        needs: [ update_version ]
        uses: ./.github/workflows/continuous-integration.yml
    tagged-release:
        name: Creating Tag and Release
        runs-on: ubuntu-latest
        needs: [ ci ]
        permissions:
            contents: write
        steps:
            -   uses: actions/checkout@v4
            -   name: Extract branch name
                shell: bash
                run: echo "APP_VERSION=${GITHUB_REF##*/}" >> $GITHUB_ENV
            -   name: Create Release & Tag
                run: gh release create ${{APP_VERSION}} --generate-notes ${{ !contains(APP_VERSION, 'Beta') || '--prerelease' }}            